# LiverSeg 3D

Приложение для 3D сегментации печени на КТ изображениях с использованием современных моделей глубокого обучения.

## Описание

LiverSeg 3D - это специализированное приложение для медицинской визуализации, предназначенное для автоматической сегментации печени на компьютерных томограммах. Приложение поддерживает различные модели глубокого обучения, включая YOLOv11, U-Net и nnU-Net, и предоставляет интуитивный графический интерфейс для загрузки DICOM данных, выполнения сегментации и визуализации результатов в 3D.

### Основные возможности

- **Загрузка DICOM данных**: Поддержка стандартных DICOM файлов и серий
- **Множественные модели сегментации**: YOLOv11, U-Net, nnU-Net
- **3D визуализация**: Интерактивная визуализация исходных данных и результатов сегментации
- **Расчет объема**: Автоматический расчет объема печени в миллилитрах
- **Интуитивный интерфейс**: Простое и понятное управление процессом сегментации

## Системные требования

### Минимальные требования

- **Операционная система**: Windows 10/11, Linux, macOS
- **Python**: 3.8 или выше
- **Оперативная память**: 8 ГБ
- **Видеокарта**: NVIDIA GPU с 4 ГБ VRAM (рекомендуется)
- **Свободное место на диске**: 5 ГБ для моделей и данных

### Рекомендуемые требования

- **Операционная система**: Windows 11, Ubuntu 20.04+
- **Python**: 3.9 или выше
- **Оперативная память**: 16 ГБ
- **Видеокарта**: NVIDIA GPU с 8 ГБ VRAM (RTX 3060 или выше)
- **Свободное место на диске**: 10 ГБ

## Установка

### Способ 1: Автоматическая установка (Windows)

1. Скачайте и распакуйте архив с приложением
2. Запустите файл `install.bat` для автоматической установки зависимостей
3. Запустите файл `run.bat` для запуска приложения

### Способ 2: Ручная установка

1. Убедитесь, что у вас установлен Python 3.8 или выше
2. Клонируйте репозиторий или скачайте исходный код
3. Создайте виртуальное окружение (рекомендуется):
   ```bash
   python -m venv venv
   source venv/bin/activate  # для Linux/macOS
   venv\Scripts\activate     # для Windows
   ```
4. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```

### Способ 3: Установка через pip (в разработке)

```bash
pip install liverseg3d
```

## Использование

### Запуск приложения

#### Windows

```bash
# Через bat-файл
run.bat

# Или напрямую через Python
python main.py
```

#### Linux/macOS

```bash
python main.py
```

### Рабочий процесс

1. **Загрузка DICOM данных**:
   - Нажмите кнопку "Select DICOM Folder"
   - Выберите папку с DICOM файлами
   - Выберите нужную серию из списка

2. **Выбор модели сегментации**:
   - Выберите модель из выпадающего списка (YOLOv11, U-Net, nnU-Net)
   - Модели имеют разные характеристики скорости и точности

3. **Запуск сегментации**:
   - Нажмите кнопку "Start Segmentation"
   - Дождитесь завершения процесса
   - Результаты появятся в 3D визуализаторе

4. **Анализ результатов**:
   - Просмотрите 3D модель печени
   - Оцените рассчитанный объем
   - При необходимости повторите с другой моделью

### Горячие клавиши

- `Ctrl+O`: Открыть папку с DICOM файлами
- `Ctrl+S`: Сохранить результаты (в разработке)
- `Ctrl+Q`: Выход из приложения
- `F5`: Обновить список DICOM серий

## Модели сегментации

### YOLOv11

- **Преимущества**: Высокая скорость обработки
- **Недостатки**: Может быть менее точным на сложных случаях
- **Рекомендуется**: Для быстрой предварительной оценки

### U-Net

- **Преимущества**: Хорошая точность, сбалансированная производительность
- **Недостатки**: Среднее время обработки
- **Рекомендуется**: Для большинства клинических случаев

### nnU-Net

- **Преимущества**: Наивысшая точность, адаптивность к различным данным
- **Недостатки**: Наибольшее время обработки
- **Рекомендуется**: Для точных исследований и сложных случаев

## Формат данных

### Поддерживаемые DICOM форматы

- CT (Компьютерная томография)
- Серии с контрастным усилением
- Нативные исследования
- Различные протоколы сканирования

### Требования к DICOM данным

- Толщина среза: 1-5 мм
- Матрица: 512x512 пикселей
- Количество срезов: не менее 50 для полноценной 3D реконструкции
- Формат: стандартный DICOM (без сжатия или с потерями)

## Структура проекта

```
InferenceAnd3D/
├── main.py                 # Основной файл запуска
├── config.py               # Конфигурация приложения
├── requirements.txt        # Зависимости Python
├── install.bat             # Скрипт установки (Windows)
├── run.bat                 # Скрипт запуска (Windows)
├── README.md               # Документация
├── CHANGELOG.md            # История версий
├── gui/                    # Графический интерфейс
│   ├── main_window.py      # Главное окно приложения
│   ├── workers.py          # Рабочие потоки
│   └── ...
├── models/                 # Модели сегментации
│   ├── model_manager.py    # Управление моделями
│   └── ...
├── utils/                  # Утилиты
│   ├── dicom_loader.py     # Загрузчик DICOM
│   └── ...
└── resources/              # Ресурсы приложения
```

## Решение проблем

### Частые проблемы

#### 1. Ошибка импорта PyQt6

**Проблема**: `ImportError: No module named 'PyQt6'`

**Решение**:
```bash
pip install PyQt6
```

#### 2. Ошибка с CUDA

**Проблема**: `CUDA out of memory` или `CUDA not available`

**Решение**:
- Убедитесь, что у вас установлена CUDA-совместимая видеокарта
- Проверьте установку драйверов NVIDIA
- При необходимости используйте CPU (автоматически)

#### 3. Медленная работа

**Проблема**: Приложение работает медленно

**Решение**:
- Используйте GPU вместо CPU
- Уменьшите размер DICOM данных
- Выберите более быструю модель (YOLOv11)

#### 4. Проблемы с DICOM файлами

**Проблема**: DICOM файлы не загружаются

**Решение**:
- Проверьте целостность файлов
- Убедитесь, что это CT исследования
- Попробуйте другую папку с DICOM файлами

### Логирование

Приложение создает лог-файл `liverseg3d.log` в директории запуска. В случае проблем проверьте этот файл для получения детальной информации об ошибках.

## Разработка

### Сборка из исходного кода

1. Клонируйте репозиторий:
```bash
git clone https://github.com/your-repo/LiverSeg3D.git
cd LiverSeg3D/InferenceAnd3D
```

2. Установите зависимости в режиме разработки:
```bash
pip install -r requirements.txt
```

3. Запустите приложение:
```bash
python main.py
```

### Тестирование

Для запуска тестов:
```bash
python -m pytest tests/
```

### Вклад в проект

Мы приветствуем вклад в проект! Пожалуйста, ознакомьтесь с руководством по внесению изменений в файле CONTRIBUTING.md.

## Лицензия

Этот проект распространяется под лицензией MIT. Подробности см. в файле LICENSE.

## Контакты

- **Разработчики**: LiverSeg Team
- **Email**: contact@liverseg3d.com
- **GitHub**: https://github.com/your-repo/LiverSeg3D
- **Документация**: https://liverseg3d.readthedocs.io

## Благодарности

- Разработчикам фреймворков PyTorch, MONAI, PyQt6
- Сообществу медицинского ИИ
- Медицинским учреждениям, предоставившим данные для обучения моделей

## Версия

Текущая версия: 1.0.0

История версий доступна в файле [CHANGELOG.md](CHANGELOG.md).